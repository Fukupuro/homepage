---
import { Icon } from "astro-icon/components";
import { PATH } from "@/constants";
---

<div class="sm:hidden relative" id="mobile-nav">
  <button type="button" class="p-2 relative w-10 h-10" aria-label="メニュー" id="menu-btn">
    <Icon name="ri:menu-line" size={28} id="menu-icon" class="absolute inset-0 m-auto" />
    <Icon name="ri:close-line" size={28} id="close-icon" class="absolute inset-0 m-auto hidden" />
  </button>

  <nav id="mobile-menu" class="fixed inset-x-0 top-20 bottom-0 bg-gray-100/60 backdrop-blur-sm hidden flex flex-col min-h-0">
    <div class="flex-1 min-h-0 overflow-y-auto flex flex-col items-center justify-start pt-32 gap-8 py-4">
      <ul class="flex flex-col items-center gap-8 text-3xl text-gray-700">
        <li><a href={PATH.HOME}>Home</a></li>
        <li><a href={PATH.BLOGS}>Blog</a></li>
        <li><a href={PATH.FAQ}>Q&A</a></li>
        <li class="flex gap-3 pt-2">
          <a href={PATH.SNS.GITHUB} target="_blank" rel="noopener noreferrer"><Icon name="ri:github-fill" size={32} /></a>
          <a href={PATH.SNS.X} target="_blank" rel="noopener noreferrer"><Icon name="ri:twitter-x-line" size={32} /></a>
        </li>
      </ul>
    </div>
  </nav>
</div>

<script>
  const btn = document.getElementById("menu-btn");
  const menu = document.getElementById("mobile-menu");
  const menuIcon = document.getElementById("menu-icon");
  const closeIcon = document.getElementById("close-icon");

  const openMenu = () => {
    menu?.classList.remove("hidden");
    menuIcon?.classList.add("hidden");
    closeIcon?.classList.remove("hidden");
    btn?.setAttribute("aria-label", "メニューを閉じる");
  };

  const closeMenu = () => {
    menu?.classList.add("hidden");
    menuIcon?.classList.remove("hidden");
    closeIcon?.classList.add("hidden");
    btn?.setAttribute("aria-label", "メニュー");
  };

  btn?.addEventListener("click", () => (menu?.classList.contains("hidden") ? openMenu() : closeMenu()));
  menu?.querySelectorAll("a").forEach((a) => a.addEventListener("click", closeMenu));
</script>
