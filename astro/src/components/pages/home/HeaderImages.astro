---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";

const imageModules = import.meta.glob<{ default: ImageMetadata }>(
	"/src/assets/images/header_images/*.png",
	{ eager: true },
);
const images = Object.entries(imageModules)
	.sort(([a], [b]) => a.localeCompare(b))
	.map(([, mod]) => mod.default);
---

<div class="header-images-splide splide" role="group" aria-label="ヘッダー画像">
  <div class="splide__track">
    <ul class="splide__list">
      {images.map((image, index) => (  
        <li class="splide__slide">  
          <div class="h-48 w-full overflow-hidden">  
            <Image src={image} alt={`福プロの活動風景${index + 1}`} class="block h-full w-full object-cover object-center" />  
          </div>
        </li>
      ))}
    </ul>
  </div>
</div>

<script>
  import Splide from "@splidejs/splide";

  const selector = ".header-images-splide";
  const elements = document.querySelectorAll(selector);

  elements.forEach((el) => {
    if (!(el instanceof HTMLElement)) return;

    // 既にこの要素に対して Splide を初期化している場合はスキップ
    if (el.dataset.splideInitialized === "true") {
      return;
    }

    el.dataset.splideInitialized = "true";

    new Splide(el, {
      type: "loop",
      autoplay: true,
      interval: 10000,
      arrows: false,
      pagination: false,
      drag: true,
      keyboard: true,
      wheel: false,
    }).mount();
  });
</script>
